{% extends 'layout.html' %}

{% block item_rs %}
<li class="nav-item">
{% endblock %}

{% block item_ro %}
<li class="nav-item dropdown">
{% endblock %}

{% block item_aws %}
<li class="nav-item active">
{% endblock %}

{% block item_f5 %}
<li class="nav-item dropdown">
{% endblock %}

{% block item_ci %}
<li class="nav-item dropdown">
{% endblock %}

{% block item_ad %}
<li class="nav-item">
{% endblock %}

{% block item_hp %}
<li class="nav-item dropdown">
{% endblock %}

{% block content %}
<div class="page-wrapper">
    <div class="container-xl">
      <!-- Page title -->
      <div class="page-header d-print-none">
        <div class="row g-2 align-items-center">
          <div class="col">
            <div class="page-pretitle">AWS instance</div>
            <h2 id='title_filter' class="page-title">
              Filter
            </h2>
          </div>
          <div class="col-12 col-md-auto ms-auto d-print-none">
            <a class="btn btn-white" onclick="resetfilter()">Reset all</a>
            <a class="btn btn-primary" onclick="fetchinstance()">Fetch instance</a>
          </div>
        </div>
      </div>
    </div>
    <div class="page-body">
      <div class="container-xl">
        <div class="card">
            <div class="card-body">
              <div class="accordion" id="accordion-example">
                <div id="accordion-env" class="accordion-item" style="border-color: #bbdefb;border-width: 3px">
                  <h2 class="accordion-header" id="heading-1">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-1" aria-expanded="true" onclick="setborder('env')">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-codesandbox" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M20 7.5v9l-4 2.25l-4 2.25l-4 -2.25l-4 -2.25v-9l4 -2.25l4 -2.25l4 2.25z"></path>
                        <path d="M12 12l4 -2.25l4 -2.25"></path>
                        <line x1="12" y1="12" x2="12" y2="21"></line>
                        <path d="M12 12l-4 -2.25l-4 -2.25"></path>
                        <path d="M20 12l-4 2v4.75"></path>
                        <path d="M4 12l4 2l0 4.75"></path>
                        <path d="M8 5.25l4 2.25l4 -2.25"></path>
                      </svg>
                      &nbsp;Environment
                    </button>
                  </h2>
                  <div id="collapse-1" class="accordion-collapse collapse show" data-bs-parent="#accordion-example" style="">
                    <div class="accordion-body pt-0">
                      <!-- should be dynamic created from database -->
                      <label class="form-check form-check-inline">
                        <input id='env_dev' class="form-check-input" type="checkbox" onclick="checkstatus('env')">
                        <span class="form-check-label" style='width:50px'>dev</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='env_int' class="form-check-input" type="checkbox" onclick="checkstatus('env')">
                        <span class="form-check-label" style='width:50px'>int</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='env_prf' class="form-check-input" type="checkbox" onclick="checkstatus('env')">
                        <span class="form-check-label" style='width:50px'>prf</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='env_qa' class="form-check-input" type="checkbox" onclick="checkstatus('env')">
                        <span class="form-check-label" style='width:50px'>qa</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='env_pie' class="form-check-input" type="checkbox" onclick="checkstatus('env')">
                        <span class="form-check-label" style='width:50px'>pie</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='env_stg' class="form-check-input" type="checkbox" onclick="checkstatus('env')">
                        <span class="form-check-label" style='width:50px'>stg</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='env_prod' class="form-check-input" type="checkbox" onclick="checkstatus('env')">
                        <span class="form-check-label" style='width:50px'>prod</span>
                      </label>
                      <hr style='margin-top:1px;margin-bottom:1px'>
                    </div>
                    <div class="accordion-body pt-0">
                      <label class="form-check form-switch">
                        <input id='env_all' class="form-check-input" type="checkbox" onclick="selectall('env')"> 
                        select all
                      </label>
                    </div>
                  </div>
                </div>
                <div id="accordion-color" class="accordion-item" style="">
                  <h2 class="accordion-header" id="heading-2">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-2" aria-expanded="false" onclick="setborder('color')">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M12 21a9 9 0 1 1 0 -18a9 8 0 0 1 9 8a4.5 4 0 0 1 -4.5 4h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25"></path>
                        <circle cx="7.5" cy="10.5" r=".5" fill="currentColor"></circle>
                        <circle cx="12" cy="7.5" r=".5" fill="currentColor"></circle>
                        <circle cx="16.5" cy="10.5" r=".5" fill="currentColor"></circle>
                      </svg>
                      &nbsp;Colorstack
                    </button>
                  </h2>
                  <div id="collapse-2" class="accordion-collapse collapse" data-bs-parent="#accordion-example" style="">
                    <div class="accordion-body pt-0">
                      <label class="form-check form-check-inline">
                        <input id='color_blue' class="form-check-input" type="checkbox" checked="" onclick="checkstatus('color')">
                        <span class="form-check-label" style='width:50px'>blue</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='color_green' class="form-check-input" type="checkbox" checked="" onclick="checkstatus('color')">
                        <span class="form-check-label" style='width:50px'>green</span>
                      </label>
                      <hr style='margin-top:1px;margin-bottom:1px'>
                    </div>
                    <div class="accordion-body pt-0">
                      <label class="form-check form-switch">
                        <input id='color_all' class="form-check-input" type="checkbox" checked="" onclick="selectall('color')"> 
                        select all
                      </label>
                    </div>
                  </div>
                </div>
                <div id="accordion-state" class="accordion-item" style="">
                  <h2 class="accordion-header" id="heading-3">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-3" aria-expanded="false" onclick="setborder('state')">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-devices" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <rect x="13" y="8" width="8" height="12" rx="1"></rect>
                        <path d="M18 8v-3a1 1 0 0 0 -1 -1h-13a1 1 0 0 0 -1 1v12a1 1 0 0 0 1 1h9"></path>
                        <line x1="16" y1="9" x2="18" y2="9"></line>
                      </svg>
                      &nbsp;Instance state
                    </button>
                  </h2>
                  <div id="collapse-3" class="accordion-collapse collapse" data-bs-parent="#accordion-example" style="">
                    <div class="accordion-body pt-0">
                      <label class="form-check form-check-inline">
                        <input id='state_pending' class="form-check-input" type="checkbox" onclick="checkstatus('state')">
                        <span class="form-check-label" style='width:100px'>pending</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='state_running' class="form-check-input" type="checkbox" checked="" onclick="checkstatus('state')">
                        <span class="form-check-label" style='width:100px'>running</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='state_shutting-down' class="form-check-input" type="checkbox" onclick="checkstatus('state')">
                        <span class="form-check-label" style='width:100px'>shutting-down</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='state_terminated' class="form-check-input" type="checkbox" onclick="checkstatus('state')">
                        <span class="form-check-label" style='width:100px'>terminated</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='state_stopping' class="form-check-input" type="checkbox" onclick="checkstatus('state')">
                        <span class="form-check-label" style='width:100px'>stopping</span>
                      </label>
                      <label class="form-check form-check-inline">
                        <input id='state_stopped' class="form-check-input" type="checkbox" onclick="checkstatus('state')">
                        <span class="form-check-label" style='width:100px'>stopped</span>
                      </label>
                      <hr style='margin-top:1px;margin-bottom:1px'>
                    </div>
                    <div class="accordion-body pt-0">
                      <label class="form-check form-switch">
                        <input id='state_all' class="form-check-input" type="checkbox" onclick="selectall('state')"> 
                        select all
                      </label>
                    </div>
                  </div>
                </div>
                <div id="accordion-partner" class="accordion-item" style="">
                  <h2 class="accordion-header" id="heading-4">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-4" aria-expanded="false" onclick="setborder('partner')">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-amongus" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M10.646 12.774c-1.939 .396 -4.467 .317 -6.234 -.601c-2.454 -1.263 -1.537 -4.66 1.423 -4.982c2.254 -.224 3.814 -.354 5.65 .214c.835 .256 1.93 .569 1.355 3.281c-.191 1.067 -1.07 1.904 -2.194 2.088z"></path>
                        <path d="M5.84 7.132c.083 -.564 .214 -1.12 .392 -1.661c.456 -.936 1.095 -2.068 3.985 -2.456a22.464 22.464 0 0 1 2.867 .08c1.776 .14 2.643 1.234 3.287 3.368c.339 1.157 .46 2.342 .629 3.537v11l-12.704 -.019c-.552 -2.386 -.262 -5.894 .204 -8.481"></path>
                        <path d="M17 10c.991 .163 2.105 .383 3.069 .67c.255 .13 .52 .275 .534 .505c.264 3.434 .57 7.448 .278 9.825h-3.881"></path>
                      </svg>
                      &nbsp;Partner
                    </button>
                  </h2>
                  <div id="collapse-4" class="accordion-collapse collapse" data-bs-parent="#accordion-example" style="">
                    <div id="collapse-partners" class="accordion-body pt-0">
                    </div>
                    <div class="accordion-body pt-0">
                      <label class="form-check form-switch">
                        <input id='partner_all' class="form-check-input" type="checkbox" checked="" onclick="selectall('partner')"> 
                        select all 
                      </label>
                    </div>
                  </div>
                </div>
                <div id="accordion-tier" class="accordion-item" style="">
                  <h2 class="accordion-header" id="heading-5">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-5" aria-expanded="false" onclick="setborder('tier')">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-components" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M3 12l3 3l3 -3l-3 -3z"></path>
                        <path d="M15 12l3 3l3 -3l-3 -3z"></path>
                        <path d="M9 6l3 3l3 -3l-3 -3z"></path>
                        <path d="M9 18l3 3l3 -3l-3 -3z"></path>
                      </svg>
                      &nbsp;Tier
                    </button>
                  </h2>
                  <div id="collapse-5" class="accordion-collapse collapse" data-bs-parent="#accordion-example" style="">
                    <div id="collapse-tiers" class="accordion-body pt-0">
                    </div>
                    <div class="accordion-body pt-0">
                      <label class="form-check form-switch">
                        <input id='tier_all' class="form-check-input" type="checkbox" checked="" onclick="selectall('tier')"> 
                        select all 
                      </label>
                    </div>
                  </div>
                </div>
                <div id="accordion-ip" class="accordion-item" style="">
                  <h2 class="accordion-header" id="heading-6">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-6" aria-expanded="false" onclick="setborder('ip')">
                      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-map-pins" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M10.828 9.828a4 4 0 1 0 -5.656 0l2.828 2.829l2.828 -2.829z"></path>
                        <line x1="8" y1="7" x2="8" y2="7.01"></line>
                        <path d="M18.828 17.828a4 4 0 1 0 -5.656 0l2.828 2.829l2.828 -2.829z"></path>
                        <line x1="16" y1="15" x2="16" y2="15.01"></line>
                      </svg>
                      &nbsp;IP address
                    </button>
                  </h2>
                  <div id="collapse-6" class="accordion-collapse collapse" data-bs-parent="#accordion-example" style="">
                    <div class="accordion-body pt-0">
                      <input id="ipaddress" type="text" class="form-control" name="example-text-input" placeholder="Input IP address, comma separated list">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
      </div>
    </div>

    <div class="container-xl">
      <div class="page-header d-print-none">
        <div class="row g-2 align-items-center">
          <div class="col">
            <div class="page-pretitle">AWS instance</div>
            <h2 id='title_details' class="page-title">
              Details
            </h2>
          </div>
        </div>
      </div>
    </div>


    <div class="page-body">
      <div class="container-xl">
        <div class="card">
          <div class="card-body">
            <div id="table-default">
              <table class="table">
                <thead>
                  <tr>
                    <th><button class="table-sort asc" data-sort="sort-host">Host</button></th>
                    <th><button class="table-sort asc" data-sort="sort-name">Name</button></th>
                    <th><button class="table-sort asc" data-sort="sort-tier">Tier</th>
                    <th><button class="table-sort asc" data-sort="sort-env">Env</th>
                    <th><button class="table-sort asc" data-sort="sort-bg">b/g</th>
                    <th><button class="table-sort asc" data-sort="sort-partner">Partner</th>
                    <th><button class="table-sort asc" data-sort="sort-state">State</th>
                    <th><button class="table-sort asc" data-sort="sort-ip">Ip</th>
                    <th><button class="table-sort asc" data-sort="sort-id">InstanceId</th>
                    <th><button class="table-sort asc" data-sort="sort-time">Time</th>
                  </tr>
                </thead>
                <tbody id='tbody-instance' class="table-tbody">
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>  
{% endblock %}

{% block js %}
<script>
  const filter_env_array = [
    'dev',
    'int',
    'prf',
    'qa',
    'pie',
    'stg',
    'prod']
  const filter_name_array = [
    'environment', 
    'colorstack',
    'instance state',
    'partner',
    'tier']
  const environment_array = [
    'env_dev', 
    'env_int', 
    'env_prf', 
    'env_qa', 
    'env_pie', 
    'env_stg', 
    'env_prod']
  const colorstack_array = [
    'color_blue', 
    'color_green']
  const instancestate_array = [
    'state_pending', 
    'state_running', 
    'state_shutting-down', 
    'state_terminated', 
    'state_stopping', 
    'state_stopped']
  partner_array = []
  tier_array = []
  blueprogressbar = '<div class="progress"><div class="progress-bar progress-bar-indeterminate bg-blue"></div></div>'
</script>

<script type='text/javascript'>
  window.onload = function () {
    initdatafromdb()
    }
</script>

<script type='text/javascript'>
  function initdatafromdb() {
    newlabels = ""
    $('#title_filter').html(blueprogressbar)

    $.ajax({
      url: '/aws/instance/initdata/',
      type: 'GET',
      data: {
        orgunit: 'gbos'
      },
      dataType: 'JSON',
      success: function(res) {
        newlabels = ""
        for (let i = 0; i < res['partners'].length; i++) {
          partner = res['partners'][i]['name']
          newlabels += "<label class=\"form-check form-check-inline\">\
            <input id=\"partner_" + partner + "\" \
            class=\"form-check-input\" type=\"checkbox\" checked=\"\" \
            onclick=\"checkstatus('partner')\">\
            <span class=\"form-check-label\" style='width:50px'>" + partner + '</span></label>'
          partner_array.push("partner_" + partner)
        }
        newlabels += "<hr style='margin-top:1px;margin-bottom:1px'>"
        $('#collapse-partners').html(newlabels)

        newlabels = ""
        for (let i = 0; i < res['tiers'].length; i++) {
          tier = res['tiers'][i]['name']

          if ( i != res['tiers'].length - 1) {
            tier_next = res['tiers'][i+1]['name']
            start_letter_cur = tier[0]
            start_letter_next = tier_next[0]
          }

          newlabels += "<label class=\"form-check form-check-inline\">\
            <input id=\"tier_" + tier + "\" \
            class=\"form-check-input\" type=\"checkbox\" checked=\"\" \
            onclick=\"checkstatus('tier')\">\
            <span class=\"form-check-label\" style='width:50px'>" + tier + '</span></label>'

          tier_array.push("tier_" + tier)

          if (start_letter_cur != start_letter_next) {
            newlabels += "<div></div>"
          }
        }
        newlabels += "<hr style='margin-top:1px;margin-bottom:1px'>"
        $('#collapse-tiers').html(newlabels)
        $('#title_filter').html('Filter')
      }
    })
  }
</script>

<script type='text/javascript'>
  function fetchinstance() {
    id_all_array = [
      environment_array, 
      colorstack_array,
      instancestate_array,
      partner_array,
      tier_array
      ]

    checked_array = [
      environments = "",
      colorstacks = "",
      instance_states = "",
      partners = "",
      tiers = "",
      ip_addresses = ""
      ]

    for (let item = 0; item < id_all_array.length; item++) {
      for (let i = 0; i < id_all_array[item].length; i++) {
        if (document.getElementById(id_all_array[item][i]).checked == 1) {
          index = id_all_array[item][i].indexOf('_')
          value = id_all_array[item][i].substring(index + 1)
          if (checked_array[item] == "") {
            checked_array[item] = value
          }
          else {
            checked_array[item] += ',' + value
          }
        }
      }
    }

    for (let i = 0; i < filter_name_array.length; i++){
      if (checked_array[i].length == 0) {
        alert('No ' + filter_name_array[i] + ' selected.')
        return
      }
    }

    checked_array[5] = document.getElementById("ipaddress").value
    //console.log(checked_array[5])
    
    $('#tbody-instance').html('<tr><td></td></tr>')
    $('#title_details').html(blueprogressbar)

    $.ajax({
      url: '/aws/instance/filter/',
      type: 'GET',
      data: {
        environments: checked_array[0],
        colorstacks: checked_array[1],
        instance_states: checked_array[2],
        partners: checked_array[3],
        tiers: checked_array[4],
        ip_addresses: checked_array[5]
      },
      dataType: 'JSON',
      success: function(res) {
        newtr = ''
        $.each(res,function(env,values){
          for (let i = 0; i< values.length; i++) {
            if (values[i]['Colorstack'] == 'blue') {
              bg_icon = "<span class='status-dot bg-blue'></span> "
            }
            else {
              bg_icon = "<span class='status-dot bg-green'></span> "
            }

            if (values[i]['State'] == 'running') {
              state_icon = "<span class='badge bg-success me-1'></span> "
            }
            else {
              state_icon = "<span class='badge bg-warning me-1'></span> "
            }
            
            newtr += "<tr>"
            newtr += "<td class='sort-host'>" + values[i]['HostName'] + "</td>"
            newtr += "<td class='sort-name'>" + values[i]['Name'] + "</td>"
            newtr += "<td class='sort-tier'>" + values[i]['Tier'].toLowerCase() + "</td>"
            newtr += "<td class='sort-env'>" + values[i]['Environment'].toLowerCase() + "</td>"
            newtr += "<td class='sort-bg'>" + bg_icon + values[i]['Colorstack'] + "</td>"
            newtr += "<td class='sort-partner'>" + values[i]['Partner'].toLowerCase() + "</td>"
            newtr += "<td class='sort-state'>" + state_icon + values[i]['State'] + "</td>"
            newtr += "<td class='sort-ip'>" + values[i]['PrivateIpAddress'] + "</td>"
            newtr += "<td class='sort-id'>" + values[i]['InstanceId'] + "</td>"
            newtr += "<td class='sort-time'>" + values[i]['LaunchTime'] + "</td>"
            newtr += "</tr>"
          }
        })
////
        $('#tbody-instance').html(newtr)
        $('#title_details').html('Details')
        const sort_list = new List('table-default', {
          sortClass: 'table-sort',
          listClass: 'table-tbody',
          valueNames: [ 'sort-host', 'sort-name', 'sort-tier', 
            'sort-env', 'sort-bg', 'sort-partner', 'sort-state', 
            'sort-ip', 'sort-id', 'sort-time']
        });
      }
    })
  }
</script>

<script type='text/javascript'>
    function selectall(type) {
        switch (type) {
            case 'env':
            value = document.getElementById('env_all').checked
            for (let i = 0; i < environment_array.length; i++) {
                document.getElementById(environment_array[i]).checked = value
            }
            break

            case 'color':
            value = document.getElementById('color_all').checked
            for (let i = 0; i < colorstack_array.length; i++) {
                document.getElementById(colorstack_array[i]).checked = value
            }
            break

            case 'state':
            value = document.getElementById('state_all').checked
            for (let i = 0; i < instancestate_array.length; i++) {
                document.getElementById(instancestate_array[i]).checked = value
            }
            break

            case 'partner':
            value = document.getElementById('partner_all').checked
            for (let i = 0; i < partner_array.length; i++) {
                document.getElementById(partner_array[i]).checked = value
            }
            break

            case 'tier':
            value = document.getElementById('tier_all').checked
            for (let i = 0; i < tier_array.length; i++) {
                document.getElementById(tier_array[i]).checked = value
            }
            break
        }
    }
</script>

<script type='text/javascript'>
    function resetfilter() {
        id_all_array = [
        environment_array, 
        colorstack_array,
        instancestate_array,
        partner_array,
        tier_array
        ]

        for (let i = 0; i < environment_array.length; i++) {
            document.getElementById(environment_array[i]).checked = 0
        }
        for (let i = 0; i < colorstack_array.length; i++) {
            document.getElementById(colorstack_array[i]).checked = 1
        }
        for (let i = 0; i < instancestate_array.length; i++) {
            document.getElementById(instancestate_array[i]).checked = 0
        }
        for (let i = 0; i < partner_array.length; i++) {
            document.getElementById(partner_array[i]).checked = 1
        }
        for (let i = 0; i < tier_array.length; i++) {
            document.getElementById(tier_array[i]).checked = 1
        }

        document.getElementById('env_all').checked = 0
        document.getElementById('color_all').checked = 1
        document.getElementById('state_all').checked = 0
        document.getElementById('partner_all').checked = 1
        document.getElementById('tier_all').checked = 1

        document.getElementById('state_running').checked = 1
    }
</script>

<script type='text/javascript'>
    function checkstatus(type) {
        switch (type) {
            case 'env':
            document.getElementById('env_all').checked = 1
            for (let i = 0; i < environment_array.length; i++) {
                if (document.getElementById(environment_array[i]).checked == 0) {
                    document.getElementById('env_all').checked = 0
                    break
                }
            }
            break

            case 'color':
            document.getElementById('color_all').checked = 1
            for (let i = 0; i < colorstack_array.length; i++) {
                if (document.getElementById(colorstack_array[i]).checked == 0 ) {
                    document.getElementById('color_all').checked = 0
                    break
                }
            }
            break

            case 'state':
            document.getElementById('state_all').checked = 1
            for (let i = 0; i < instancestate_array.length; i++) {
                if (document.getElementById(instancestate_array[i]).checked == 0 ) {
                    document.getElementById('state_all').checked = 0
                    break
                }
            }
            break

            case 'partner':
            document.getElementById('partner_all').checked = 1
            for (let i = 0; i < partner_array.length; i++) {
                if (document.getElementById(partner_array[i]).checked == 0 ) {
                    document.getElementById('partner_all').checked = 0
                    break
                }
            }
            break

            case 'tier':
            document.getElementById('tier_all').checked = 1
            for (let i = 0; i < tier_array.length; i++) {
                if (document.getElementById(tier_array[i]).checked == 0) {
                    document.getElementById('tier_all').checked = 0
                    break
                }
            }
            break
        }
    }
</script>

<script type='text/javascript'>
  function setborder(type) {
    accordion_all = ['env', 'color', 'state', 'partner', 'tier', 'ip']
    accordion_name = ("accordion-" + type)
    
    style = document.getElementById(accordion_name).getAttribute("style")
    if (style.length == 0) {
      document.getElementById(accordion_name).setAttribute("style", "border-color: #bbdefb;border-width: 3px;border-top-style: solid")
    }
    else {
      document.getElementById(accordion_name).setAttribute("style", "")
    }
    for (let i in accordion_all) {
      if (accordion_all[i] != type) {
        document.getElementById("accordion-" + accordion_all[i]).setAttribute("style", "")
      }
    }
  }
</script>
{% endblock %}